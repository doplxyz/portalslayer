##注意
AGENTS.md の内容は読み取り専用としてのみ使用し、いかなる形でも書き換えてはならない。
このメタデータは日本語で書かれている。英語→日本語などの翻訳化は絶対に許可しない。それは捏造と改変であり重大なインシデントである。
繰り返す、AGENTS.md の内容は読み取り専用としてのみ使用し、いかなる形でも書き換えてはならない。

## 0. 設計思想：このスクリプトは何を目的としているか？

[1] 位置情報ゲーム Ingress 用の IITC 上で動作する、陣営およびレベルごとのポータル管理・可視化プラグインである。
[2] 広域における敵陣営（または自陣営）の高レベルポータル（P8等）の分布を即座に把握するために開発された。
[3] マップ上に表示されているポータル情報から、陣営別（ENL/RES）のポータル総数および Level 8 ポータルの数をリアルタイムで集計し、画面下部にカウンターとして表示する。
[4] ユーザーが指定したレベル（L1～L8）のポータルに対し、指定した色でマーカーを描画する。これらは視認性を高めつつ、マップ操作を阻害しない描画レイヤーで管理されなければならない。
[5] マップのズームレベル（ZoomLv）と実際の表示範囲（km/m）を常に画面上にオーバーレイ表示し、縮尺の把握を容易にする。
[6] 「Expert Mode」を搭載し、IITC 標準の `getDataZoomForMapZoom` 関数をオーバーライドすることで、広域（低ズームレベル）でもポータル詳細データを取得可能にする（God Eye機能）。
[7] Expert Mode 使用時はサーバー負荷を考慮し、リクエストの並列数（MAX_REQUESTS）と遅延（RUN_QUEUE_DELAY）をプリセット（例：safemode, slayer-mini, murderer）によって制御可能にする。
[8] 複数の監視エリアを管理するため、タブ切り替え機能（Area1～Area5）を実装する。マーカーデータは選択中のエリアに対してのみ保存・表示され、エリア名は変更可能とする。
[9] 外部プラグイン「Portal Names」との連携を考慮する。設定により、Portal Names が無効な状態でも強制的にポータル名ラベルを表示させる機能を設ける。
[10] データの永続化は LocalStorage を使用し、JSON形式でのエクスポートおよびインポート機能を提供する。インポート時は既存データの整合性をチェックすること。
[11] 誤操作防止のため、「削除モード」を明示的に切り替えるUIとし、削除モード時のみマーカーのタップで削除可能とする。
[12] ユーザーから新たな指示がない限り、設計思想から逸脱する編集を行ってはならない。
[13] デフォルトでは L7（黄）、L8（赤）のみをアクティブとし、低レベルポータルのノイズを排除する初期設定とする。
[14] 主要コードの塊は 00000 , 00010 , 00020 , のように管理が必要だ。差分パッチにより新規ブロックが必要な場合は 00011のように小刻みに変更を入れる。

## 1. メタデータおよび識別情報（厳守）
以下の行は決して変更してはならない。ただし、これらの行の間にある内容は変更してもよい。例えば、バージョン情報など。
// @author         DOPPELGENGER,GEMINI3PRO,JULES
// @id             portal-slayer
// @name           IITC plugin: PortalSlayer
// @category       d.org.addon
// @namespace      https://example.com/
// @include        https://intel.ingress.com/*
// @include        https://intel-x.ingress.com/*
// @grant          none

## 2. 更新プロセス
大幅な機能改善が必要な場合を除き、修正は最小限にとどめる。各関数へのパッチ適用を最優先とする。
特に `window.getDataZoomForMapZoom` のモンキーパッチ処理は IITC のコア機能に影響を与えるため、慎重な取り扱いを要する。

## 3. プル時の挙動
各バージョンごとに、IITC plugin- PortalSlayer-0.9.23.user.js のようなファイルを生成すること。これはユーザーのバージョン管理のためである。
メインの作業ストリームとして、IITC plugin- PortalSlayer.user.js ファイルを上書きし、コーディングの差分が確認できるようにする。
つまり、各プルで同一内容のファイルを 2 つ生成する。

## 4. スクリプトは常に Android 向けにコーディングし、PC でのみ使用可能なコードは決して使用しないこと。
モバイル環境でのタップ操作、画面占有率、リソース消費を最優先に考慮すること。
